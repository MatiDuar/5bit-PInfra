<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:c="http://java.sun.com/jsp/jstl/core">

<h:head></h:head>
<body>
	<div class="card">
		<h:form>
			<p:dataTable var="personas" value="#{dtFilterView.personas}"
				widgetVar="personasTable"
				emptyMessage="Personas no encontradas con este criterio"
				filteredValue="#{dtFilterView.filteredPersonas}"
				globalFilterFunction="#{dtFilterView.globalFilterFunction}"
				editable="true" id="dateTable" selectionMode="single"
				rowKey="#{gestionPersona.personasMod}"
				>

				<p:ajax event="rowEdit" listener="#{gestionPersona.onRowEdit}"
					update="dateTable" />
				<p:ajax event="rowEditCancel"
					listener="#{gestionPersona.onRowCancel}" update="dateTable" />
				<p:ajax event="rowEditInit"
					listener="#{gestionPersona.changeAlumno}" />



				<f:facet name="header">
					<div class="flex justify-content-end">
						<p:inputText id="globalFilter"
							onkeyup="PF('personasTable').filter()" style="width:300px"
							placeholder="Buscardor global..." />
					</div>
				</f:facet>


				<p:column field="nombre1" headerText="Nombre"
					sortBy="#{personas.nombre1}" filterable="false">
					<p:cellEditor>
						<f:facet name="output">
							<h:outputText style="vertical-align: middle; margin-left: .5rem"
								value="#{personas.nombre1}" />
						</f:facet>
						<f:facet name="input" class="col-10">
							<p:inputText
								style="width:100%;vertical-align: middle; margin-left: .5rem"
								value="#{personas.nombre1}" />
						</f:facet>
					</p:cellEditor>
				</p:column>

				<p:column field="apellido1" headerText="Apellido" filterable="false">
					<p:cellEditor>
						<f:facet name="output">
							<h:outputText style="vertical-align: middle; margin-left: .5rem"
								value="#{personas.apellido1}" />
						</f:facet>
						<f:facet name="input" class="col-10">
							<p:inputText
								style="width:100%;vertical-align: middle; margin-left: .5rem"
								value="#{personas.apellido1}" />
						</f:facet>
					</p:cellEditor>
				</p:column>

				<p:column field="mail" headerText="Email" filterable="false">
					<p:cellEditor>
						<f:facet name="output">
							<h:outputText style="vertical-align: middle; margin-left: .5rem"
								value="#{personas.mail}" />
						</f:facet>
						<f:facet name="input" class="col-10">
							<p:inputText
								style="width:100%;vertical-align: middle; margin-left: .5rem"
								value="#{personas.mail}" />
						</f:facet>
					</p:cellEditor>
				</p:column>

				<p:column field="nombreUsuario" headerText="Nombre de Usuario"
					filterable="false">
					<p:cellEditor>
						<f:facet name="output">
							<h:outputText style="vertical-align: middle; margin-left: .5rem"
								value="#{personas.nombreUsuario}" />
						</f:facet>
						<f:facet name="input" class="col-10">
							<p:inputText
								style="width:100%;vertical-align: middle; margin-left: .5rem"
								value="#{personas.nombreUsuario}" />
						</f:facet>
					</p:cellEditor>
				</p:column>
				<p:column field="direccion" headerText="Direccion"
					filterable="false">
					<p:cellEditor>
						<f:facet name="output">
							<h:outputText style="vertical-align: middle; margin-left: .5rem"
								value="#{personas.direccion}" />
						</f:facet>
						<f:facet name="input" class="col-10">

							<p:inputText
								style="width:100%;vertical-align: middle; margin-left: .5rem"
								value="#{personas.direccion}" />
						</f:facet>
					</p:cellEditor>
				</p:column>
				<p:column headerText="Edad" filterable="false">


					<h:outputText style="vertical-align: middle; margin-left: .5rem"
						value="#{dtFilterView.currentYear-(personas.fechaNacimiento.year+1900)}" />

				</p:column>

				<p:column headerText="Carrera" filterable="false">
					<p:cellEditor>
						<f:facet name="output">
							<h:outputText style="vertical-align: middle; margin-left: .5rem"
								value="#{dtFilterView.buscar(personas.id).carrera.nombre}" />
						</f:facet>
						<f:facet name="input" class="col-10">
							<p:selectOneMenu id="groupCarreraMod"
								value="#{gestionPersona.carreraMod}"
								rendered="#{dtFilterView.esAlumno(personas)}">
								<f:selectItem itemLabel="" itemValue="" />
								<c:forEach var="carrera" items="#{gestionPersona.carreras}">
									<f:selectItem itemLabel="#{carrera.nombre}"
										itemValue="#{carrera.nombre}" />
								</c:forEach>
							</p:selectOneMenu>
						</f:facet>
					</p:cellEditor>
				</p:column>



				<p:column headerText="Id Estudiante" filterable="false">
					<p:cellEditor>
						<f:facet name="output">
							<h:outputText style="vertical-align: middle; margin-left: .5rem"
								value="#{dtFilterView.buscar(personas.id).idEstudiantil}" />
						</f:facet>
						<f:facet name="input" class="col-10">

							<p:inputText
								style="width:100%;vertical-align: middle; margin-left: .5rem"
								value="#{gestionPersona.idEstudianteMod}"
								rendered="#{dtFilterView.esAlumno(personas)}" />
						</f:facet>

					</p:cellEditor>
				</p:column>

<!-- 				<p:column style="width:6rem" headerText=""> -->
<!-- 					<p:rowEditor editTitle="Edit Row" cancelTitle="Cancel Edit" -->
<!-- 						saveTitle="Save Row" /> -->
<!-- 				</p:column> -->

			</p:dataTable>
		</h:form>
	</div>
</body>
</html>
